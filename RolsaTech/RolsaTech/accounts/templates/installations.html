{% extends 'base.html' %}

{% block title %}
Installations
{% endblock %}

{% block content %}
<div class="flex-1 flex flex-col items-center justify-center m-4">
    <div class="w-full md:w-4/5 lg:1/2 xl:w-1/3 text-start flex flex-col gap-4 bg-white border border-gray-400 rounded-xl p-4">
        <h1>
            My Installations
        </h1>
        {% if installations %}
        <div class="cards overflow-auto grid grid-cols-1 md:grid-cols-2 gap-2">
            {% for installation in installations %}
            <div class="flex flex-col gap-1 bg-gray-50">
                <h3>Installation #{{ installation.id }}</h3>
                <p>
                    <span class="material-symbols-rounded">calendar_today</span>
                    {{ installation.date }}
                </p>
                <p>
                    <span class="material-symbols-rounded">pin_drop</span>
                    {{ installation.first_line }}, {{ installation.postcode }}
                </p>
                <div class="flex flex-row gap-1">
                    <a href="{% url 'edit_installation' installation.id %}" class="flex-1"><button type="button" class="w-full">
                        <span class="material-symbols-rounded">edit</span>
                        Edit
                    </button></a>
                    <a href="{% url 'delete_installation' installation.id %}" class="flex-1"><button type="button" class="w-full">
                        <span class="material-symbols-rounded">delete</span>
                        Delete
                    </button></a>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        No installations booked! Book one now by pressing the button below.
        {% endif %}
        <a href="{% url 'create_installation' %}"><button type="button" class="w-full">
            <span class="material-symbols-rounded">add_circle</span>
            Book an installation
        </button></a>

        <!-- Admin section to see all installations booked -->
        {% if request.user.is_superuser %}
        <h1>
            All Installations
        </h1>
        {% if all_installations %}
        <div class="cards overflow-auto grid grid-cols-1 md:grid-cols-2 gap-2">
            {% for installation in all_installations %}
            <div class="flex flex-col gap-1 bg-gray-50">
                <h3>Installation #{{ installation.id }}</h3>
                <p>
                    <span class="material-symbols-rounded">person</span>
                    {{ installation.user }}
                </p>
                <p>
                    <span class="material-symbols-rounded">calendar_today</span>
                    {{ installation.date }}
                </p>
                <div class="flex flex-row gap-1">
                    <a href="{% url 'edit_installation' installation.id %}" class="flex-1"><button type="button" class="w-full">
                        <span class="material-symbols-rounded">edit</span>
                        Edit
                    </button></a>
                    <a href="{% url 'delete_installation' installation.id %}" class="flex-1"><button type="button" class="w-full">
                        <span class="material-symbols-rounded">delete</span>
                        Delete
                    </button></a>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        No booked installations.
        {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}
